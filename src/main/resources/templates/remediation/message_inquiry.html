<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:include="/common/head :: head">
    <title>[Sample] EMC Message Inquiry</title>
    <!--<link rel="stylesheet" type="text/css" href="/css/mdl-material.min.css">-->
    <!--<link rel="stylesheet" type="text/css" href="/css/materialize.min.css">-->
    <!--<link rel="stylesheet" type="text/css" href="/css/icon.css">-->
    <!--<link rel="stylesheet" type="text/css" href="/css/main.css">-->
    <!--<script src="/js/jquery-3.2.1.min.js"></script>-->
    <!--<script src="/js/materialize.min.js"></script>-->
    <!--<script src="/js/sweetalert2.all.min.js"></script>-->
    <!--<script src="/js/main.js"></script>-->
    <!--<style>-->
        <!--.center{-->
            <!--text-align: center;-->
        <!--}-->
    <!--</style>-->
</head>
<body>
<!--LOADING SCREEN-->
<div id="loading-screen" class="modal">
    <div class="modal-content valign-wrapper" style="height: 100%;
             <!--/*background:#ebeff4;*/-->
                <!--background: transparent">
        <!--<h4 style="color:steelblue;">LOADING</h4>-->
        <!--<img src="images/loading.gif" height="200">-->
        <div class="preloader-wrapper big active">
            <div class="spinner-layer spinner-yellow-only">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div><div class="gap-patch">
                <div class="circle"></div>
            </div><div class="circle-clipper right">
                <div class="circle"></div>
            </div>
            </div>
        </div>
    </div>
</div>

<!--NAVBAR-->
<nav th:replace="/common/navbar :: nav" id="page-header">
    <!--<div class="nav-wrapper">-->
    <!--<a href="#" data-activates="side-nav-bar" class="button-collapse">-->
    <!--<i class="material-icons">menu</i>-->
    <!--</a>-->
    <!--<div class="brand-logo left hide-on-small-only">-->
    <!--<img src="/images/ehealth-logo.png">-->
    <!--</div>-->
    <!--<h5 class="brand-logo center" id="page-title">-->
    <!--REMEDIATION QUEUE-->
    <!--</h5>-->
    <!--<ul id="nav-mobile" class="right">-->
    <!--<li>-->
    <!--<a href="#" class="dropdown-button" data-activates="user-actions">-->
    <!--<i class="material-icons left">account_box</i>-->
    <!--<span th:text="${@login.commonName}"></span>-->
    <!--</a>-->
    <!--</li>-->
    <!--</ul>-->
    <!--</div>-->
</nav>

<!--USER ACTIONS DROPDOWN-->
<ul th:replace="/common/user_actions :: user-actions" id='user-actions' class='dropdown-content'>
    <!--<li class="center user-info">-->
    <!--<i class="material-icons">account_circle</i>-->
    <!--<br>-->
    <!--Logged in as-->
    <!--<br>-->
    <!--<span th:text="${@login.username}"></span>-->
    <!--<br>-->
    <!--</li>-->
    <!--<li class="divider"></li>-->
    <!--<li class="action">-->
    <!--<button class="btn waves-effect waves-light" onclick="location.href='/login?logout'">Logout</button>-->
    <!--</li>-->
</ul>

<!--SLIDE OUT MENU-->
<ul id="side-menu" class="side-nav">
    <li><a href="#!" class="nav-link"><i class="material-icons">home</i>Home</a></li>
    <li><a href="#!" class="nav-link"><i class="material-icons">dns</i>Terminology Registry</a></li>
    <li><a href="#!" class="nav-link"><i class="material-icons">assignment</i>Consent</a></li>
    <li><a href="#!" class="nav-link"><i class="material-icons">account_balance</i>CORP</a></li>
    <li><div class="divider"></div></li>
    <li class="center">
        <a class="subheader">Data Remediation</a>
    </li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i> Search Remediation Queue</a></li>
    <li class="center">
        <a class="subheader" >Message Inquiry</a>
    </li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>Message Inquiry</a></li>
    <li class="center">
        <a class="subheader">EMC SCI Admin</a>
    </li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>EID Remediation Search</a></li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>EID Remediation Summary</a></li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>Person Search</a></li>
    <li class="center">
        <a class="subheader">Reports</a>
    </li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>Message Error Categories</a></li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>EID Match Summary</a></li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>EID Balance Report</a></li>
    <li class="center">
        <a class="subheader">MI Exam Code Dictionary</a>
    </li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>Upload Exam Code Dictionary</a></li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>Search Exam Code Dictionary</a></li>
    <li class="reg-link"><a href="#"><i class="material-icons">keyboard_arrow_right</i>Add Exam Code</a></li>
    <!--DUMMY-->
    <li class="center">
        <a class="subheader"></a>
    </li>
</ul>

<div class="row" id="sub-page-header">
    <br>
    <div class="col s4">
    </div>
    <div class="col s4 center content">
        <div class="img-holder z-depth-2">
            <img src="/images/lab_remediation_error.png" height="75px">
        </div>
    </div>
</div>
<div class="row" id="sticky-page-header">
    <div class="col s3">
        <button class="btn-floating btn-large waves-effect waves-light button-collapse"
                title="Show Menu Bar" id="show-menu" data-activates="side-menu">
            <i class="material-icons medium">menu</i>
        </button>
    </div>
    <div class="col s6 center content">
        <h5 style="text-align: center;">MESSAGE INQUIRY</h5>
    </div>
</div>

<!---->
<!--FORMS-->
<!---->

<div class="container" id="main" style="width: 70%">
    <br><br>
    <form action="/search" id="msg-search-form">

        <div class="row form-row z-depth-2" id="dom-sel">
            <div class="col s12 center">
                        <span class="btn btn-floating counter">
                            <i class="material-icons">language</i>
                        </span>
                <br>
                <h5 class="title">Domain Selection</h5>
                <hr>
            </div>
            <div class="col s4 input-field">
                <select name="domain" onchange="changeDomain($(this).val())">
                    <option value="CE">Clinical Encounters</option>
                    <option value="LAB" selected>Lab</option>
                    <option value="MIR">Medical Imaging Reports</option>
                    <!--<option value="CDM">Chronic Disease Management</option>-->
                    <option value="CDR">Clinical Documents</option>
                </select>
                <label>Domain</label>
            </div>
        </div>

        <br>

        <div class="row form-row z-depth-2" id="lab-rem-err">
            <div class="col s12 center">
                        <span class="btn btn-floating counter">
                            <i class="material-icons">description</i>
                        </span>
                <br>
                <h5 class="title">Message Inquiry</h5>
                <hr>
            </div>
            <div class="col s6 input-field">
                <label class="LAB-only CE-only MIR-only CDM-only CDR-only hideable">Message Control ID</label>
                <input type="text" name="message-control-id" url-updater data-reset-fordomain="true">
            </div>
            <div class="col s6 input-field">
                <label class="LAB-only hideable">Order Number</label>
                <label class="CE-only hideable">Visit Number</label>
                <label class="MIR-only CDR-only hideable">Document ID</label>
                <label class="CDM-only hideable">Document Set ID</label>
                <input type="text" name="order-number" url-updater data-reset-fordomain="true">
            </div>
            <!--<div class="col s4 input-field">-->
            <!--<select name="source" multiple url-updater>-->
            <!--<option value="" disabled selected>Source</option>-->
            <!--<option value="CHR">CHR</option>-->
            <!--<option value="FHHR">FHHR</option>-->
            <!--<option value="HRCA">HRCA</option>-->
            <!--<option value="ICL">ICL</option>-->
            <!--<option value="KRHA">KRHA</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--<div class="col s4 input-field">-->
            <!--<select name="status" multiple url-updater>-->
            <!--<option value="" disabled selected>Status</option>-->
            <!--<option value="NEW">New</option>-->
            <!--<option value="ASS">Assigned</option>-->
            <!--<option value="MRR">Message Resend Requested</option>-->
            <!--<option value="RER">Remediation Resend</option>-->
            <!--<option value="CLO">Closed</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--<div class="col s4 input-field">-->
            <!--<select name="assigned-to" url-updater>-->
            <!--<option value="" disabled selected>Assigned To</option>-->
            <!--<option value="jdoe">EHS - John Doe</option>-->
            <!--<option value="jsmith1">HRS - Jane Smith</option>-->
            <!--<option value="selse">HRS - Someone Else</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--<div class="col s4 input-field">-->
            <!--<select name="message-type" multiple url-updater>-->
            <!--<option value="" disabled selected>Message Type</option>-->
            <!--<option value="lab-blood-bank">LAB - Blood Bank</option>-->
            <!--<option value="lab-general">LAB - General</option>-->
            <!--<option value="lab-microbiology">LAB - Microbiology</option>-->
            <!--<option value="lab-pathology">LAB - Pathology</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--<div class="col s4 input-field">-->
            <!--<select name="error-category" url-updater>-->
            <!--<option value="" disabled selected>Error Category</option>-->
            <!--<option value="cat1">Category 1</option>-->
            <!--<option value="cat2">Category 2</option>-->
            <!--<option value="cat3">Category 3</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--<div class="col s4 input-field">-->
            <!--<select name="routable" url-updater>-->
            <!--<option value="" disabled selected>Routable</option>-->
            <!--<option value="yes">Yes</option>-->
            <!--<option value="no">No</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--<div class="col s4 input-field">-->
            <!--<label>Error Description</label>-->
            <!--<input type="text" name="error-description" url-updater>-->
            <!--</div>-->
            <div>
                <div class="col s3 input-field">
                    <label class="active">From Date</label>
                    <input type="text" class="datepicker" name="from-date" url-updater data-reset-fordomain="true">
                </div>
                <div class="col s3 input-field">
                    <label class="active">Time</label>
                    <input type="text" onchange="Materialize.updateTextFields()" class="timepicker" name="from-time" url-updater
                           data-reset-fordomain="true">
                </div>

            </div>
            <div>
                <div class="col s3 input-field">
                    <label class="active">To Date</label>
                    <input type="text" class="datepicker" name="to-date" url-updater data-reset-fordomain="true">
                </div>
                <div class="col s3 input-field">
                    <label class="active">Time</label>
                    <input type="text" onchange="Materialize.updateTextFields()" class="timepicker" name="to-time" url-updater
                           data-reset-fordomain="true">
                </div>
            </div>
            <div class="col s6 input-field hideable MIR-only">
                <select name="source" data-reset-fordomain="true">
                    <option style="display:none"></option>
                    <option value="CBR-MAYFAIR">CBR-MAYFAIR</option>
                    <option value="CBR-RAR">CBR-RAR</option>
                    <option value="RIS_HNAM">RIS_HNAM</option>
                    <option value="RIS_XIRIS">RIS_XIRIS</option>
                </select>
                <label>Source</label>
            </div>

            <!--<div class="col s12 center adv-search">-->
            <!--<b>Advanced Search</b>-->
            <!--<hr>-->
            <!--<button type="button" class="btn btn-floating waves-light waves-effect">-->
            <!--<i class="material-icons">add</i>-->
            <!--</button>-->
            <!--</div>-->

            <!--<div class="col s6 input-field adv-search-field">-->
            <!--<select name="error-type" multiple url-updater>-->
            <!--<option value="" disabled selected>Error Type</option>-->
            <!--<option value="data-exceeds-maximum-length">Data Exceeds <br>Maximum Length</option>-->
            <!--<option value="historical-type">Historical Type</option>-->
            <!--<option value="invalid-datatype">Invalid Datatype</option>-->
            <!--<option value="location-not-active">Location Not Active</option>-->
            <!--<option value="location-not-found">Location Not Found</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--<div class="col s6 input-field adv-search-field">-->
            <!--<select name="resolution-type" multiple url-updater>-->
            <!--<option value="" disabled selected>Resolution Type</option>-->
            <!--<option value="verified">Verified</option>-->
            <!--<option value="outstanding">Outstanding</option>-->
            <!--<option value="no-issue">No Issue</option>-->
            <!--</select>-->
            <!--</div>-->
            <!--<div class="col s6 input-field adv-search-field">-->
            <!--<label>From Date</label>-->
            <!--<input type="text" class="datepicker" name="from-date" url-updater>-->
            <!--</div>-->
            <!--<div class="col s6 input-field adv-search-field">-->
            <!--<label class="active">To Date</label>-->
            <!--<input type="datetime-local" class="" name="to-date" url-updater>-->
            <!--</div>-->
            <!--SEARCH AND CLEAR BUTTONS-->
            <div class="col s12"></div>
            <div class="col s3 offset-s3 center form-row-action">
                <button type="button" class="btn waves-effect waves-light"
                        onclick="fetchSearchRecords($(this).closest('form'))" id="msg-form-search-btn">
                    <i class="material-icons left">search</i>Search
                </button>
            </div>
            <div class="col s3 center form-row-action">
                <button type="reset" class="btn waves-effect waves-light" onclick="clearPage()">
                    <i class="material-icons left">autorenew</i>Clear
                </button>
            </div>

        </div>

        <br><br>
    </form>

    <div class="row form-row z-depth-2 hiddendiv" id="ser-res" style="border-bottom: none;margin-bottom: 0px">
        <div class="col s12 center">
                    <span class="btn btn-floating counter">
                        <i class="material-icons">search</i>
                    </span>
            <br>
            <h5 class="title">Search Results</h5>
            <hr>
        </div>
    </div>

    <div class="row form-row z-depth-1-half hiddendiv" style="padding: 0px; overflow-x: auto" id="res-tab">
        <!--TABLE DYNAMICALLY LOADED HERE-->
    </div>

    <br>

</div>

<!--STICKY TOOLBAR-->
<div class="row sticky-footer z-depth-2 active hiddendiv" id="sticky-action-footer">
    <div class="col s3">
        <i class="material-icons left">list</i>
        Show <b id="record-count">50</b> records per page
        <button class="btn btn-floating right waves-effect waves-light disabled" style="margin-top: -5px">
            <i class="material-icons">replay</i>
        </button>
        <p class="range-field" style="margin-bottom: 0px;margin-top: 2px">
            <input type="range" id="page-size" min="20" max="100" value="50"
                   onchange="$('#record-count').text($(this).val())"/>
        </p>
    </div>
    <div class="col s1"></div>
    <div class="col s4 center">
        <ul class="pagination" style="margin-top: 20px">
            <!--<li class="waves-effect tooltipped" data-position="top" data-delay="50" data-tooltip="Page 1">-->
            <!--&lt;!&ndash;<a ><i class="material-icons">first_page</i></a>&ndash;&gt;-->
            <!--</li>-->
            <li class="disabled" id="page-back" page-value=""><a href="#!"><i class="material-icons">chevron_left</i></a></li>
            <li class="active" id="page-current"><a href="#!">1</a></li>
            <!--<li class="waves-effect"><a href="#!">2</a></li>-->
            <!--<li class="waves-effect"><a href="#!">3</a></li>-->
            <!--<li class="waves-effect"><a href="#!">4</a></li>-->
            <!--<li class="waves-effect"><a href="#!">5</a></li>-->
            <li class="waves-effect" id="page-forward" page-value=""><a href="#!"><i class="material-icons">chevron_right</i></a></li>
            <!--<li class="waves-effect tooltipped" data-position="top" data-delay="50" data-tooltip="Page 100">-->
            <!--<a href="#!"><i class="material-icons">last_page</i></a>-->
            <!--</li>-->
        </ul>
    </div>
    <div class="col s1"></div>
    <div class="col s2 center">
        <button class="btn btn-floating waves-light waves-effect msg-action toolbar-item disabled"
                title="Close Message(s)" onclick="openMessageAction('closeMessages')">
            <i class="material-icons">close</i>
        </button>
        <button class="btn btn-floating waves-light waves-effect msg-action toolbar-item disabled"
                title="Assign To" onclick="openMessageAction('assignTo')">
            <i class="material-icons">supervisor_account</i>
        </button>
        <button class="btn btn-floating waves-light waves-effect msg-action toolbar-item disabled"
                title="Remediation Resend">
            <i class="material-icons">compare_arrows</i>
        </button>
    </div>
    <div class="col s1"></div>
</div>
<!--TOOLBAR SHOW/HIDE BUTTON-->
<button class="btn btn-floating waves-effect waves-light hiddendiv"
        id="toggle-action-footer" title="Hide Toolbar" onclick="toggleToolbar($('#sticky-action-footer'),$(this))">
    <i class="material-icons">keyboard_arrow_down</i>
</button>
<!--CLOSE MESSAGES ACTION MODAL-->
<div class="modal action-modal" id="act-close-messages" data-action="closeMessages">
    <div class="modal-content center">
        <div class="progress hiddendiv">
            <div class="indeterminate"></div>
        </div>
        Are you sure you want to close the selected message(s)?
    </div>
    <div class="modal-footer">
        <div class="row">
            <div class="col s6 center">
                <button class="btn-flat waves-effect waves-light" onclick="closeMessages()">
                    <i class="material-icons left">thumb_up</i>YES
                </button>
            </div>
            <div class="col s6 center">
                <button class=" btn-flat waves-effect waves-light modal-close">
                    <i class="material-icons left">thumb_down</i>CANCEL
                </button>
            </div>
        </div>
    </div>
</div>
<!--ASSIGN TO ACTION MODAL-->
<div class="modal action-modal" id="act-assign-to" data-action="assignTo">
    <div class="modal-content center">
        <div class="row title">
            <div class="col s12 center">
                <i class="material-icons medium">supervisor_account</i>
            </div>
            <div class="col s12 center">
                <b>ASSIGN MESSAGE(S) TO</b>
            </div>
            <hr>
        </div>
        <div class="progress hiddendiv">
            <div class="indeterminate"></div>
        </div>
        <div class="input-field">
            <select id="sel-assign-to">
                <option value="" disabled selected>Select a User</option>
                <option value="jdoe">EHS - John Doe</option>
                <option value="jsmith1">HRS - Jane Smith</option>
                <option value="selse">HRS - Someone Else</option>
                <option value="kkovach">HRS - Karen Kovach</option>
            </select>
        </div>
    </div>
    <div class="modal-footer">
        <div class="row">
            <div class="col s6 center">
                <button class="btn-flat waves-effect waves-light" onclick="assignTo()">
                    <i class="material-icons left">thumb_up</i>YES
                </button>
            </div>
            <div class="col s6 center">
                <button class="btn-flat waves-effect waves-light modal-close">
                    <i class="material-icons left">thumb_down</i>CANCEL
                </button>
            </div>
        </div>
    </div>
</div>

<div id="message-content-modal" class="modal message-modal modal-fixed-footer">
    <div class="modal-content center">
        <div class="modal-header center" style="text-align: center">
            <h5 >VIEW MESSAGE - <span data-attribute="message-control-id">12706580</span></h5>
            <hr>
            <span class="msg-txt"></span>
            <br>
            <div class="image-holder valign-wrapper">
                <img src="/images/med-document.png">
            </div>
        </div>
        <br><br>
        <div class="content">
            <div class="row">

                <table class="workflow-table bordered z-depth-1 white centered">
                    <thead>
                    <th>Event Time</th>
                    <th>Event Description</th>
                    <th>Error Detail</th>
                    <th>Major Code</th>
                    <th>Minor Code</th>
                    </thead>
                </table>

                <div class="col s12 input-field msg-content" id="view-msg-content">
                    <span class="label">Message Content</span>
                    <textarea class="materialize-textarea" readonly></textarea>
                    <div class="msg-content-action center" style="text-align: center">
                        <button class="btn waves-light waves-effect"
                                onclick="showMessageContent($('#message-content-modal').attr('correlation-id')
                                        ,'#view-msg-content')">
                            <i class="material-icons left">visibility</i>
                            CLICK TO VIEW MESSAGE CONTENT
                        </button>
                        <div class="progress">
                            <div class="indeterminate"></div>
                        </div>
                    </div>
                </div>
                <br>

                <div class="col s12 input-field msg-content" id="view-trns-msg">
                    <span class="label">Transformed Message</span>
                    <textarea class="materialize-textarea" readonly></textarea>
                    <div class="msg-content-action center">
                        <button class="btn waves-light waves-effect hiddendiv"
                                onclick="showMessageContent($('span[data-attribute=message-control-id]').text()
                                        ,'#view-trns-msg')">
                            <i class="material-icons left">visibility</i>
                            CLICK TO VIEW TRANSFORMED MESSAGE
                        </button>
                        <div class="progress">
                            <div class="indeterminate"></div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="modal-footer center">
        <a class="btn modal-close waves-effect waves-green teal lighten-2">
            <i class="material-icons left">close</i>&nbsp;Close
        </a>
        <a class="btn waves-effect waves-green teal lighten-2" onclick="showSavedURL()">
            <i class="material-icons left">link</i>&nbsp;Generate Link
        </a>
    </div>
</div>

<div class="fixed-action-btn" style="margin-right: 2rem">
    <a class="btn-floating btn-large grey lighten-1" onclick="showSavedURL()">
        <i class="material-icons">link</i>
    </a>
</div>

<div id="details-footer">

</div>

<script src="/js/mdl-material.js"></script>
<script src="/js/jquery.dataTables.min.js"></script>
<script src="/js/jquery.highlight.js"></script>
<script src="/js/search.js"></script>
<script>
    function changeDomain(val) {
        $('.hideable').hide();
        $("*[data-reset-fordomain=true]").val('');
        Materialize.updateTextFields();
        $("select[data-reset-fordomain=true]").material_select();
        $('.'+val+'-only').show();
        $("msg-search-form").on("change", "#eventType", function(event){
            event.delegateTarget.reset();
        })
    }
    $(document).ready(function () {
        changeDomain('LAB');
    });
</script>
</body>
</html>